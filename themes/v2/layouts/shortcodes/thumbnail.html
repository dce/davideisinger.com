{{ $orig := .Page.Resources.GetMatch (printf "*%s*" (.Get 0)) }}
{{ $options := .Get 1 }}

{{ $img := $orig.Resize $options }}

{{ if findRE `\d+x\d+` $options }}
  {{ $img = $orig.Fill $options }}
{{ end }}

<figure>
  <a href="{{ $orig.RelPermalink }}">
    <img src="{{ $img.RelPermalink }}" width="{{ $img.Width }}" height="{{ $img.Height }}">
    <figcaption>
      {{ with .Inner }}
        {{ . }}
      {{ end }}
    </figcaption>
  </a>
</figure>
